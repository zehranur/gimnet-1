if(typeof global==="undefined")global=window;var Q$Externals={};Q$Externals.formatDayHourAndMin=function(t){if(t===0)return"0";else if(!t)return"";var e=Math.floor(t/24/60);var n="";if(e>0){n+=e.toString()}var r=$.pi.zeroPad(Math.floor(t%(24*60)/60),2)+":"+$.pi.zeroPad(t%60,2);if(r!="00:00"){if(e>0)n+=".";n+=r}return n};Q$Externals.formatISODateTimeUTC=function(t){if(t==null)return"";var e=function(t){return(t<10?"0":"")+t};var n=t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes());var r=Number(t.getUTCSeconds()+"."+(t.getUTCMilliseconds()<100?"0":"")+e(t.getUTCMilliseconds()));n+=":"+e(r)+"Z";return n};Q$Externals.formatNumber=function(t,e,n,r){var a="-";if(isNaN(t)){return null}var i="";if(e.indexOf(".")>-1){var l=n;var o=e.substring(e.lastIndexOf(".")+1);t=new Number(Q$Externals.roundNumber(t,o.length));var s=t%1;var u=new String(s.toFixed(o.length));u=u.substring(u.lastIndexOf(".")+1);for(var d=0;d<o.length;d++){if(o.charAt(d)=="#"&&u.charAt(d)!="0"){l+=u.charAt(d);continue}else if(o.charAt(d)=="#"&&u.charAt(d)=="0"){var f=u.substring(d);if(f.match("[1-9]")){l+=u.charAt(d);continue}else break}else if(o.charAt(d)=="0")l+=u.charAt(d)}i+=l}else t=Math.round(t);var c=Math.floor(t);if(t<0)c=Math.ceil(t);var p="";if(e.indexOf(".")==-1)p=e;else p=e.substring(0,e.indexOf("."));var h="";if(!(c==0&&p.substr(p.length-1)=="#")){var g=new String(Math.abs(c));var v=9999;if(p.lastIndexOf(",")!=-1)v=p.length-p.lastIndexOf(",")-1;var $=0;for(var d=g.length-1;d>-1;d--){h=g.charAt(d)+h;$++;if($==v&&d!=0){h=r+h;$=0}}if(p.length>h.length){var m=p.indexOf("0");if(m!=-1){var Q=p.length-m;var x=p.length-h.length-1;while(h.length<Q){var y=p.charAt(x);if(y==",")y=r;h=y+h;x--}}}}if(!h&&p.indexOf("0",p.length-1)!==-1)h="0";i=h+i;if(t<0)i=a+i;if(i.lastIndexOf(n)==i.length-1){i=i.substring(0,i.length-1)}return i};Q$Externals.roundNumber=function(t,e){var n=Math.pow(10,e||0);var r=String(Math.round(t*n)/n);if(e>0){var a=r.indexOf(".");if(a==-1){r+=".";a=0}else{a=r.length-(a+1)}while(a<e){r+="0";a++}}return r};Q$Externals.isoRegexp=/(\d{4,})(?:-(\d{1,2})(?:-(\d{1,2})(?:[T ](\d{1,2}):(\d{1,2})(?::(\d{1,2})(?:\.(\d+))?)?(?:(Z)|([+-])(\d{1,2})(?::(\d{1,2}))?)?)?)?)?/;Q$Externals.logDateToString=function(t){if(t){return Q.formatDate(Q$Externals.parseISODateTime(t),Q$Culture.dateTimeFormat.replace(":ss",""))}else return""};Q$Externals.logDateUserToString=function(t,e){var n="";if(t){n=Q.formatDate($.pi.parseISODateTime(t),Q$Culture.dateTimeFormat.replace(":ss",""))}if(e&&e.length){if(n.length)n+=" ";n+="("+e+")"}return n};Q$Externals.logDateUserToShortString=function(t,e){var n="";if(t){n=Q.formatDate(Q$Externals.parseISODateTime(t),Q$Culture.dateFormat.replace("yyyy","yy"))}if(e&&e.length){if(n.length)n+=" ";n+=e}return n};Q$Externals.parseInteger=function(t){t=Q.trim(t.toString());var e=Q$Culture.get_groupSeperator();if(t&&t.length&&t.indexOf(e)>0){t=t.replace(new RegExp("(\\b\\d{1,3})\\"+e+"(?=\\d{3}(\\D|$))","g"),"$1")}if(!/^[-\+]?\d+$/.test(t))return NaN;return parseInt(t,10)};Q$Externals.parseDate=function(t,e){if(!t||!t.length)return null;var n;var r;var a,i,l;r=Q$Externals.splitDateString(t);if(!r)return false;if(r.length==3){e=e||Q$Culture.dateOrder;switch(e){case"dmy":a=parseInt(r[0],10);i=parseInt(r[1],10)-1;l=parseInt(r[2],10);break;case"ymd":a=parseInt(r[2],10);i=parseInt(r[1],10)-1;l=parseInt(r[0],10);break;case"mdy":default:a=parseInt(r[1],10);i=parseInt(r[0],10)-1;l=parseInt(r[2],10);break}if(isNaN(a)||isNaN(i)||isNaN(l)||a<1||a>31||i<0||i>11||l>9999||l<0)return false;if(l<100){var o=(new Date).getFullYear();var s=o%100+10;l+=o-o%100+(l<=s?0:-100)}try{n=new Date(l,i,a);if(isNaN(n.getFullYear()))return false}catch(u){return false}}else if(r.length==1){try{n=new Date(r[0]);if(isNaN(n.getFullYear()))return false}catch(u){return false}}return n};Q$Externals.parseDecimal=function(t){t=Q.trim(t.toString());var e=Q$Culture.get_groupSeperator();if(t&&t.length&&t.indexOf(e)>0){t=t.replace(new RegExp("(\\b\\d{1,3})\\"+e+"(?=\\d{3}(\\D|$))","g"),"$1")}if(!new RegExp("^\\s*([-\\+])?(\\d*)\\"+Q$Culture.decimalSeparator+"?(\\d*)\\s*$").test(t))return NaN;return parseFloat(t.toString().replace(Q$Culture.decimalSeparator,"."))};Q$Externals.splitDateString=function(t){t=$.trim(t);if(!t.length)return;var e;if(t.indexOf("/")>=0)e=t.split("/");else if(t.indexOf(".")>=0)e=t.split(".");else if(t.indexOf("-")>=0)e=t.split("-");else if(t.indexOf("\\")>=0)e=t.split("\\");else e=[t];return e};Q$Externals.parseISODateTime=function(t){if(!t||!t.length)return null;var e=Date.parse(t);if(!isNaN(e)&&typeof e=="Date")return e;t=t+"";if(typeof t!="string"||t.length===0){return null}var n=t.match(Q$Externals.isoRegexp);if(typeof n=="undefined"||n===null){return null}var r,a,i,l,o,s,u;r=parseInt(n[1],10);if(typeof n[2]=="undefined"||n[2]===""){return new Date(r)}a=parseInt(n[2],10)-1;i=parseInt(n[3],10);if(typeof n[4]=="undefined"||n[4]===""){return new Date(r,a,i)}l=parseInt(n[4],10);o=parseInt(n[5],10);s=typeof n[6]!="undefined"&&n[6]!==""?parseInt(n[6],10):0;if(typeof n[7]!="undefined"&&n[7]!==""){u=Math.round(1e3*parseFloat("0."+n[7]))}else{u=0}if((typeof n[8]=="undefined"||n[8]==="")&&(typeof n[9]=="undefined"||n[9]==="")){return new Date(r,a,i,l,o,s,u)}var d;if(typeof n[9]!="undefined"&&n[9]!==""){d=parseInt(n[10],10)*36e5;if(typeof n[11]!="undefined"&&n[11]!==""){d+=parseInt(n[11],10)*6e4}if(n[9]=="-"){d=-d}}else{d=0}return new Date(Date.UTC(r,a,i,l,o,s,u)-d)};Q$Externals.parseHourAndMin=function(t){var e=Q.trim(t);if(e.length<4||e.length>5)return NaN;var n,r;if(e.charAt(1)==":"){n=$.pi.parseInteger(e.substr(0,1));r=$.pi.parseInteger(e.substr(2,2))}else{if(e.charAt(2)!=":")return NaN;n=$.pi.parseInteger(e.substr(0,2));r=$.pi.parseInteger(e.substr(3,2))}if(isNaN(n)||isNaN(r)||n<0||n>23||r<0||r>59)return NaN;return n*60+r};Q$Externals.parseDayHourAndMin=function(t){var e;var n=Q.trim(t);if(!n)return NaN;n=n.split(".");if(n.length==0||n.length>2)return NaN;if(n.length==1){e=$.pi.parseInteger(n[0]);if(!isNaN(e))return e*24*60;return $.pi.parseHourAndMin(n[0])}else{e=$.pi.parseInteger(n[0]);var r=$.pi.parseHourAndMin(n[1]);if(isNaN(e)||isNaN(r))return NaN;return e*24*60+r}};Q$Externals.parseQueryString=function(t){var e;if(arguments.length==0)e=location.search.substring(1,location.search.length);else e=t||"";var n={};var r=e.split("&");for(var a=0;a<r.length;a++){var i=r[a].split("=");var l=decodeURIComponent(i[0]);n[l]=i.length>=2?decodeURIComponent(i[1]):l}return n};Q$Externals.turkishLocaleCompare=function(t,e){var n="AaBbCcÇçFfGgĞğHhIıİiJjKkLlMmNnOoÖöPpRrSsŞşTtUuÜüVvYyZz";t=t||"";e=e||"";if(t==e)return 0;if(!Q$Externals.turkishLocaleIndex){Q$Externals.turkishLocaleIndex={};for(var r=0;r<n.length;r++){Q$Externals.turkishLocaleIndex[n.charAt(r)]=r+1}}for(var a=0,i=Math.min(t.length,e.length);a<i;a++){var l=t.charAt(a),o=e.charAt(a);if(l===o)continue;var s=Q$Externals.turkishLocaleIndex[l],u=Q$Externals.turkishLocaleIndex[o];if(s!=null&&u!=null)return s<u?-1:1;var d=l.localeCompare(o);if(d==0)continue;return d}return t.localeCompare(e)};Q$Externals.turkishLocaleToUpper=function(t){if(!t)return t;return t.replace(/i/g,"İ").replace(/ı/g,"I").toUpperCase()};Q$Externals.alertDialog=function(t,e){var n;e=$.extend({htmlEncode:true,okButton:Q.text("Dialogs.OkButton"),title:Q.text("Dialogs.AlertTitle"),onClose:null,onOpen:null,autoOpen:false,dialogClass:"s-MessageDialog s-AlertDialog",modal:true,width:"40%",maxWidth:"450",minWidth:"180",resizable:false,open:function(){if(e.onOpen)e.onOpen.call(this)},close:function(){n.dialog("destroy");if(e.onClose)e.onClose()}},e);if(e.htmlEncode)t=Q.htmlEncode(t);if(!e.buttons){var r=[];r.push({text:e.okButton,click:function(){n.dialog("close")}});e.buttons=r}n=$('<div><div class="message"></div></div>').dialog(e).children(".message").html(t).parent().dialog("open")};Q$Externals.confirmDialog=function(t,e,n){var r;n=$.extend({htmlEncode:true,yesButton:Q.text("Dialogs.YesButton"),noButton:Q.text("Dialogs.NoButton"),title:Q.text("Dialogs.ConfirmationTitle"),onNo:null,onCancel:null,onClose:null,autoOpen:false,modal:true,dialogClass:"s-MessageDialog s-ConfirmDialog",width:"40%",maxWidth:"450",minWidth:"180",resizable:false,open:function(){if(n.onOpen)n.onOpen.call(this)},close:function(){r.dialog("destroy");if(!a&&n.onCancel)n.onCancel()},overlay:{opacity:.7,background:"black"}},n);if(n.htmlEncode)t=Q.htmlEncode(t);var a=false;if(!n.buttons){var i=[];i.push({text:n.yesButton,click:function(){a=true;r.dialog("close");if(e)e()}});if(n.noButton)i.push({text:n.noButton,click:function(){a=true;r.dialog("close");if(n.onNo)n.onNo();else if(n.onCancel)n.onCancel()}});n.buttons=i}r=$('<div><div class="message"></div></div>').dialog(n).children(".message").html(t).parent().dialog("open")};Q$Externals.iframeDialog=function(t){var e;var n=$("<div><iframe></iframe></div>");var r=$.extend({autoOpen:true,modal:true,width:"60%",height:"400",title:Q.text("Dialogs.AlertTitle"),open:function(){e=n.find("iframe").css({border:"none",width:"100%",height:"100%"})[0].contentDocument;e.open();e.write(r.html);e.close()},close:function(){e.open();e.write("");e.close();n.dialog("destroy").html("")}},t);n.dialog(r)};Q$Externals.setupAjaxIndicator=function(){var t=null;var e=0;$(document).ajaxStart(function(){window.clearTimeout(e);e=window.setTimeout(function(){if(!t)t=$("<div/>").addClass("s-AjaxIndicator").appendTo(document.body)},2e3)}).ajaxStop(function(){if(t){t.remove();t=null}window.clearTimeout(e)})};Q$Externals.toId=function(t){if(t==null)return null;if(typeof t=="number")return t;t=$.trim(t);if(t==null||!t.length)return null;if(t.length>=15)return t;return parseInt(t,10)};Q$Externals.jQueryValidationInitialization=function(){Serenity.CustomValidation.registerValidationMethods();jQuery.validator.addMethod("xss",function(t,e){if(t.length==0)return true;var n=0;while(true){var r=t.indexOf("&",n);if(r<0)r=t.indexOf("<",n);if(r<0)return true;if(r==t.length-1)return true;var a=t.charAt(r);var i=t.charAt(r+1);if(a!="&"){if(a=="<"&&(i>="a"&&i<="z"||i>="A"&&i<="Z"||i=="!"||i=="/"))return false}else if(i=="#")return false;n=r+1}});$.validator.addMethod("dateQ",function(t,e){return this.optional(e)||Q$Externals.parseDate(t)!=false});$.validator.addMethod("hourAndMin",function(t,e){return this.optional(e)||!isNaN(Q.parseHourAndMin(t))});$.validator.addMethod("dayHourAndMin",function(t,e){return this.optional(e)||!isNaN(Q.parseDayHourAndMin(t))});$.validator.addMethod("decimalQ",function(t,e){return this.optional(e)||!isNaN(Q.parseDecimal(t))});$.validator.addMethod("integerQ",function(t,e){return this.optional(e)||!isNaN(Q.parseInteger(t))});var t=$.validator.methods.email;$.validator.addMethod("email",function(e,n){if(!Q$Config.emailAllowOnlyAscii)return t.call(this,e,n);return this.optional(n)||/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e)});$.validator.addMethod("emailMultiple",function(t,e){var n=this.optional(e);if(n)return n;if(t.indexOf(";")>=0)t=t.split(";");else t=t.split(",");for(var r=0;r<t.length;r++){n=$.validator.methods.email.call(this,t[r],e);if(!n)return n}return n});$.validator.addMethod("anyvalue",function(t,e){return true});$.validator.defaults.ignoreTitle=true;$.validator.defaults.onchange=function(t){this.element(t)};$.validator.prototype.oldinit=$.validator.prototype.init;$.validator.prototype.init=function(){$.validator.prototype.oldinit.call(this);function t(t){if(this.form==null)return;var e=$.data(this.form,"validator"),n="on"+t.type.replace(/^validate/,"");e&&e.settings[n]&&e.settings[n].call(e,this)}function e(e){var n=this[0];if(!$.data(n,"changebound")){$(n).change(t);$.data(n,"changebound",true)}}$(this.currentForm).validateDelegate(":text, :password, :file, select, textarea","focusin",e)};$.validator.prototype.oldfocusInvalid=$.validator.prototype.focusInvalid;$.validator.prototype.focusInvalid=function(){if(this.settings.abortHandler)this.settings.abortHandler(this);this.oldfocusInvalid.call(this);if($.fn.qtip){var t=$("label.error",this.currentForm).not(".checked").eq(0);if(t.length){t.qtip("show")}}};$.validator.prototype.oldstopRequest=$.validator.prototype.focusInvalid;$.validator.prototype.stopRequest=function(t,e){var n=this.formSubmitted;this.oldfocusInvalid.call(this,[t,e]);if(!e&&this.pendingRequest==0&&n&&this.settings.abortHandler){this.settings.abortHandler(this)}};$.validator.prototype.resetAll=function(){this.submitted={};this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass)};jQuery(function(){$.extend($.validator.messages,{email:Q.text("Validation.Email"),required:Q.text("Validation.Required"),minlength:Q.text("Validation.MinLength"),maxlength:Q.text("Validation.MaxLength"),digits:Q.text("Validation.Digits"),range:Q.text("Validation.Range"),xss:Q.text("Validation.Xss"),dateQ:Q.text("Validation.DateInvalid"),decimalQ:Q.text("Validation.Decimal"),integerQ:Q.text("Validation.Integer"),url:Q.text("Validation.Url")})})};Q$Externals.validatorAbortHandler=function(t){t.settings.abortHandler=null;t.settings.submitHandler=function(){return false}};Q$Externals.validateAddTip=function(t){if($.fn.qtip){t.qtip({style:{classes:"ui-tooltip-red",widget:false}})}};Q$Externals.validateDelTip=function(t){if($.fn.qtip&&t.data("qtip")){t.qtip("destroy").attr("title","")}};Q$Externals.validateShowLabel=function(t,e){var n=this.errorsFor(t);if(n.length){n.removeClass().addClass(this.settings.errorClass);if(n.attr("generated"))n.attr("title",e);Q$Externals.validateAddTip(n)}else{n=$("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(t),generated:true}).addClass(this.settings.errorClass).attr("title",e||"");if(this.settings.wrapper){n=n.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()}if(!this.labelContainer.append(n).length)this.settings.errorPlacement?this.settings.errorPlacement(n,$(t)):n.insertAfter(t);Q$Externals.validateAddTip(n)}if(!e&&this.settings.success){typeof this.settings.success=="string"?n.addClass(this.settings.success):this.settings.success(n);n.attr("title","")}this.toShow=this.toShow.add(n)},Q$Externals.validateOptions=function(t){$.validator.prototype.showLabel=Q$Externals.validateShowLabel;return $.extend({ignore:":hidden",meta:"v",errorClass:"error",errorPlacement:function(t,e){var n=null;var r=e.attr("data-vx-id");if(r){n=$("#"+r);if(!n.length)n=null;else n=n[0]}if(n==null){n=e.parents("div.field");if(n.length){var a=$("div.vx",n[0]);if(a.length)n=a[0]}else n=e.parent()}t.appendTo(n)},submitHandler:function(){return false},invalidHandler:function(){Q.notifyError(Q.text("Validation.InvalidFormMessage"),"error")},success:function(t){t.addClass("checked");Q$Externals.validateDelTip(t)}},t)};if(window.jQuery&&window.jQuery.validator)Q$Externals.jQueryValidationInitialization();else if(window.jQuery){jQuery(function(t){if(t.validator)Q$Externals.jQueryValidationInitialization()})}Q$Externals.jQueryDatepickerInitialization=function(){var t=Q$Culture.dateOrder;var e=Q$Culture.dateSeparator;var n=($("html").attr("lang")||"en").toLowerCase();if(!$.datepicker.regional[n]){n=n.split("-")[0];if(!$.datepicker.regional[n]){n="en"}}$.datepicker.setDefaults($.datepicker.regional["en"]);$.datepicker.setDefaults($.datepicker.regional[n]);$.datepicker.setDefaults({dateFormat:t=="mdy"?"mm"+e+"dd"+e+"yy":t=="ymd"?"yy"+e+"mm"+e+"dd":"dd"+e+"mm"+e+"yy",buttonImage:Q.resolveUrl("~/content/serenity/images/datepicker.gif"),buttonImageOnly:true,showOn:"both",showButtonPanel:true,changeMonth:true,changeYear:true})};if(window.jQuery&&window.jQuery.datepicker&&window.jQuery.datepicker.regional&&window.jQuery.datepicker.regional.en)Q$Externals.jQueryDatepickerInitialization();else jQuery(function(t){if(t.datepicker)Q$Externals.jQueryDatepickerInitialization()});Q$Externals.jQuerySelect2Initialization=function(){$.ui.dialog.prototype._allowInteraction=function(t){if($(t.target).closest(".ui-dialog").length){return true}return!!$(t.target).closest(".ui-datepicker, .select2-drop, .cke, .cke_dialog, #support-modal").length}};if(window.jQuery&&window.jQuery.ui)Q$Externals.jQuerySelect2Initialization();else jQuery(function(t){if(window.jQuery.ui)Q$Externals.jQuerySelect2Initialization()});Q$Externals.postToService=function(t){var e=$("<form/>").attr("method","POST").attr("action",t.url?Q.resolveUrl(t.url):Q.resolveUrl("~/services/"+t.service)).appendTo(document.body);if(t.target)e.attr("target",t.target);var n=$("<div/>").appendTo(e);$("<input/>").attr("type","hidden").attr("name","request").val($.toJSON(t.request)).appendTo(n);$("<input/>").attr("type","submit").appendTo(n);e.submit();window.setTimeout(function(){e.remove()},0)};Q$Externals.postToUrl=function(t){var e=$("<form/>").attr("method","POST").attr("action",Q.resolveUrl(t.url)).appendTo(document.body);if(t.target)e.attr("target",t.target);var n=$("<div/>").appendTo(e);if(t.params!=null){for(var r in t.params){$("<input/>").attr("type","hidden").attr("name",r).val(t.params[r]).appendTo(n)}}$("<input/>").attr("type","submit").appendTo(n);e.submit();window.setTimeout(function(){e.remove()},0)};Q$Externals.ssExceptionInitialization=function(){window.ss.Exception.prototype.toString=function(){return this.get_message()}};if(window.ss&&window.ss.Exception)Q$Externals.ssExceptionInitialization();else jQuery(function(t){if(window.ss&&window.ss.Exception)Q$Externals.ssExceptionInitialization()});global.Q$Externals=Q$Externals;function showInFrame(t){height=screen.availHeight-60;width=screen.availWidth-10;var e=(screen.availWidth-width)/2-5;if(e<0)e=0;var n=(screen.availHeight-height)/2-25;if(n<0)n=0;var r=window.open("","","status=0, toolbar=0, width="+width+", height="+height+", scrollbars=1, resizable=yes, left="+e+", top="+n);r.document.body.innerHTML=t}if($.fn.button&&$.fn.button.noConflict){var btn=$.fn.button.noConflict();$.fn.btn=btn}